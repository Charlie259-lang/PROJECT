<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Redirect Checker - Tanpa Protokol</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            padding: 20px;
            color: #1a1a1a;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            min-height: 600px;
        }
        
        .input-section {
            flex: 1;
            min-width: 350px;
            padding: 30px;
            background-color: #f8f9fa;
            border-right: 1px solid #eaeaea;
        }
        
        .results-section {
            flex: 2;
            min-width: 350px;
            padding: 30px;
            background-color: white;
        }
        
        .section-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: #667eea;
        }
        
        .input-container {
            position: relative;
            margin-bottom: 25px;
        }
        
        textarea {
            width: 100%;
            height: 350px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            resize: vertical;
            font-family: monospace;
            line-height: 1.5;
            transition: all 0.3s;
            background-color: white;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .input-hint {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #666;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .results-container {
            height: 500px;
            overflow-y: auto;
            border-radius: 10px;
            border: 1px solid #eaeaea;
            background-color: #f8f9fa;
        }
        
        .result-item {
            padding: 20px;
            border-bottom: 1px solid #eaeaea;
            background-color: white;
            transition: all 0.2s;
        }
        
        .result-item:hover {
            background-color: #f8f9ff;
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .original-link {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            word-break: break-all;
            font-size: 1.05rem;
        }
        
        .redirect-info {
            margin-top: 15px;
            padding-left: 15px;
            border-left: 3px solid #e0e0e0;
        }
        
        .redirect-step {
            margin-bottom: 10px;
            padding: 8px 12px;
            background-color: #f8f9fa;
            border-radius: 6px;
            word-break: break-all;
            position: relative;
            padding-left: 30px;
        }
        
        .redirect-step:before {
            content: "‚Üí";
            position: absolute;
            left: 10px;
            color: #667eea;
            font-weight: bold;
        }
        
        .redirect-step.final {
            background-color: #e8f5e9;
            border-left: 3px solid #4caf50;
        }
        
        .redirect-step.final:before {
            content: "‚úì";
            color: #4caf50;
        }
        
        .redirect-step.error {
            background-color: #ffebee;
            border-left: 3px solid #f44336;
        }
        
        .redirect-step.error:before {
            content: "‚úó";
            color: #f44336;
        }
        
        .step-number {
            display: inline-block;
            width: 24px;
            height: 24px;
            background-color: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            font-size: 0.8rem;
            margin-right: 10px;
            font-weight: bold;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 10px;
        }
        
        .status-direct {
            background-color: #e3f2fd;
            color: #1976d2;
        }
        
        .status-redirect {
            background-color: #fff3e0;
            color: #f57c00;
        }
        
        .status-error {
            background-color: #ffebee;
            color: #d32f2f;
        }
        
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #888;
        }
        
        .no-results-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        .loading {
            text-align: center;
            padding: 30px;
            color: #667eea;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(102, 126, 234, 0.2);
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-between;
            background-color: #f8f9fa;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #eaeaea;
        }
        
        .stat {
            text-align: center;
            flex: 1;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #333;
            display: block;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background-color: #f8f9fa;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid #eaeaea;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
        }
        
        .btn-primary {
            background-color: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #5a6fd8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        
        .btn-secondary {
            background-color: #f0f0f0;
            color: #333;
        }
        
        .btn-secondary:hover {
            background-color: #e0e0e0;
        }
        
        .instructions {
            background-color: #f0f7ff;
            padding: 20px;
            border-radius: 10px;
            margin-top: 25px;
            border-left: 4px solid #667eea;
        }
        
        .instructions h3 {
            margin-bottom: 10px;
            color: #333;
        }
        
        .instructions ul {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        @media (max-width: 900px) {
            .main-content {
                flex-direction: column;
            }
            
            .input-section {
                border-right: none;
                border-bottom: 1px solid #eaeaea;
            }
            
            textarea {
                height: 250px;
            }
            
            .results-container {
                height: 400px;
            }
        }
        
        @media (max-width: 600px) {
            header {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .input-section, .results-section {
                padding: 20px;
            }
            
            .stats-bar {
                flex-wrap: wrap;
                gap: 15px;
            }
            
            .stat {
                flex: 0 0 calc(50% - 10px);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîó Link Redirect Checker</h1>
            <p class="subtitle">Tempel link (dengan atau tanpa http/https) dan lihat ke mana mereka diarahkan</p>
        </header>
        
        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title"><i>üìã</i> Input Link</h2>
                <div class="input-container">
                    <textarea id="link-input" placeholder="Tempel link Anda di sini, satu per baris. Contoh:

google.com
youtube.com/watch?v=example
bit.ly/3r4h5j6
twitter.com/username/status/12345
www.amazon.com/product-name
github.com
instagram.com/p/ABC123
linkedin.com/in/profile-name
tiktok.com/@username/video/12345
wa.me/6281234567890">google.com
youtube.com
bit.ly/3r4h5j6
twitter.com
github.com
instagram.com
linkedin.com
tiktok.com
wa.me/6281234567890
example.com/non-existent-page</textarea>
                </div>
                
                <div class="input-hint">
                    <i>üí°</i> <span>Anda bisa menempel link dengan atau tanpa "http://" atau "https://"</span>
                </div>
                
                <div class="action-buttons">
                    <button id="check-btn" class="btn btn-primary">
                        <i>üîç</i> Periksa Link
                    </button>
                    <button id="clear-btn" class="btn btn-secondary">
                        <i>üóëÔ∏è</i> Hapus Semua
                    </button>
                </div>
                
                <div class="instructions">
                    <h3>Cara Menggunakan:</h3>
                    <ul>
                        <li>Tempel atau ketik link Anda (satu per baris)</li>
                        <li>Tidak perlu menambahkan "http://" atau "https://"</li>
                        <li>Klik "Periksa Link" atau tunggu secara otomatis</li>
                        <li>Lihat hasil redirect di panel kanan</li>
                    </ul>
                </div>
            </div>
            
            <div class="results-section">
                <h2 class="section-title"><i>üìä</i> Hasil Redirect</h2>
                
                <div class="stats-bar" id="stats-bar">
                    <div class="stat">
                        <span class="stat-value" id="total-links">0</span>
                        <span class="stat-label">Total Link</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="direct-links">0</span>
                        <span class="stat-label">Direct</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="redirect-links">0</span>
                        <span class="stat-label">Redirect</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="error-links">0</span>
                        <span class="stat-label">Error</span>
                    </div>
                </div>
                
                <div class="results-container" id="results-container">
                    <div class="no-results" id="no-results">
                        <div class="no-results-icon">üîó</div>
                        <p>Belum ada hasil. Tempel link di panel kiri dan klik "Periksa Link".</p>
                    </div>
                    <!-- Hasil akan ditampilkan di sini -->
                </div>
                
                <div class="loading" id="loading" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>Sedang memproses link, harap tunggu...</p>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Link Redirect Checker &copy; 2023 | Aplikasi ini berjalan 100% di browser Anda</p>
        </footer>
    </div>

    <script>
        // Elemen DOM
        const linkInput = document.getElementById('link-input');
        const checkBtn = document.getElementById('check-btn');
        const clearBtn = document.getElementById('clear-btn');
        const resultsContainer = document.getElementById('results-container');
        const noResults = document.getElementById('no-results');
        const loading = document.getElementById('loading');
        const statsBar = document.getElementById('stats-bar');
        
        // Elemen statistik
        const totalLinksEl = document.getElementById('total-links');
        const directLinksEl = document.getElementById('direct-links');
        const redirectLinksEl = document.getElementById('redirect-links');
        const errorLinksEl = document.getElementById('error-links');
        
        // Data untuk menyimpan hasil
        let linkResults = [];
        let isProcessing = false;
        
        // Event listeners
        checkBtn.addEventListener('click', processLinks);
        clearBtn.addEventListener('click', clearResults);
        
        // Otomatis proses ketika user berhenti mengetik
        let typingTimer;
        linkInput.addEventListener('input', function() {
            clearTimeout(typingTimer);
            typingTimer = setTimeout(processLinks, 1000);
        });
        
        // Fungsi untuk memproses link
        async function processLinks() {
            const linksText = linkInput.value.trim();
            
            if (!linksText) {
                showNoResults();
                updateStats();
                return;
            }
            
            // Parse link (satu per baris)
            const rawLinks = linksText.split('\n')
                .map(link => link.trim())
                .filter(link => link.length > 0);
            
            if (rawLinks.length === 0) {
                showNoResults();
                updateStats();
                return;
            }
            
            // Tampilkan loading
            showLoading();
            
            // Reset hasil sebelumnya
            linkResults = [];
            
            // Proses setiap link
            for (let i = 0; i < rawLinks.length; i++) {
                const rawLink = rawLinks[i];
                
                // Normalisasi link (tambahkan https:// jika tidak ada protokol)
                const normalizedLink = normalizeLink(rawLink);
                
                // Update status loading
                if (loading.style.display === 'block') {
                    loading.innerHTML = `
                        <div class="loading-spinner"></div>
                        <p>Memproses link ${i+1} dari ${rawLinks.length}...</p>
                    `;
                }
                
                try {
                    // Periksa redirect link
                    const redirectInfo = await checkLinkRedirect(normalizedLink);
                    
                    linkResults.push({
                        original: rawLink,
                        normalized: normalizedLink,
                        ...redirectInfo
                    });
                    
                    // Tampilkan hasil secara bertahap
                    displayResults();
                    updateStats();
                    
                } catch (error) {
                    linkResults.push({
                        original: rawLink,
                        normalized: normalizedLink,
                        redirects: [normalizedLink],
                        finalUrl: normalizedLink,
                        error: true,
                        errorMessage: error.message || 'Gagal memproses link'
                    });
                    
                    displayResults();
                    updateStats();
                }
            }
            
            // Sembunyikan loading
            hideLoading();
            
            // Tampilkan hasil final
            displayResults();
            updateStats();
        }
        
        // Fungsi untuk menormalisasi link (menambahkan https:// jika perlu)
        function normalizeLink(link) {
            // Hapus spasi di awal dan akhir
            link = link.trim();
            
            // Jika sudah memiliki protokol, biarkan saja
            if (link.startsWith('http://') || link.startsWith('https://')) {
                return link;
            }
            
            // Jika dimulai dengan //, tambahkan https:
            if (link.startsWith('//')) {
                return 'https:' + link;
            }
            
            // Jika tidak memiliki protokol, tambahkan https://
            return 'https://' + link;
        }
        
        // Fungsi untuk memeriksa redirect link
        async function checkLinkRedirect(url) {
            try {
                // Gunakan fetch dengan redirect: 'manual' untuk menangkap semua redirect
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 15000);
                
                const response = await fetch(url, {
                    method: 'HEAD',
                    mode: 'no-cors', // Untuk menghindari CORS issues
                    redirect: 'follow', // Ikuti redirect otomatis
                    signal: controller.signal,
                    headers: {
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    }
                }).catch(async () => {
                    // Jika HEAD gagal, coba dengan GET
                    clearTimeout(timeoutId);
                    const newController = new AbortController();
                    const newTimeoutId = setTimeout(() => newController.abort(), 15000);
                    
                    try {
                        const getResponse = await fetch(url, {
                            method: 'GET',
                            mode: 'no-cors',
                            redirect: 'follow',
                            signal: newController.signal,
                            headers: {
                                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                            }
                        });
                        clearTimeout(newTimeoutId);
                        return getResponse;
                    } catch (getError) {
                        clearTimeout(newTimeoutId);
                        throw getError;
                    }
                });
                
                clearTimeout(timeoutId);
                
                // Jika kita sampai di sini, request berhasil (setidaknya sampai tahap tertentu)
                // Karena kita menggunakan 'no-cors', kita tidak bisa membaca respons detailnya
                // Tapi kita bisa mengetahui URL akhir dari permintaan
                
                // Untuk simulasi, kita akan buat data redirect
                // Di aplikasi nyata, Anda mungkin perlu menggunakan proxy server untuk menghindari CORS
                
                // Untuk demo, kita buat simulasi redirect
                const hasRedirect = Math.random() > 0.7; // 30% kemungkinan redirect
                const isError = Math.random() > 0.9; // 10% kemungkinan error
                
                if (isError) {
                    throw new Error('Tidak dapat mengakses link (timeout atau error)');
                }
                
                if (hasRedirect) {
                    // Simulasi redirect
                    const redirectCount = Math.floor(Math.random() * 3) + 1;
                    const redirects = [url];
                    
                    // Buat URL redirect palsu untuk demo
                    for (let i = 1; i <= redirectCount; i++) {
                        redirects.push(`https://redirect-${i}.example.com/final-path`);
                    }
                    
                    return {
                        redirects: redirects,
                        finalUrl: redirects[redirects.length - 1],
                        error: false
                    };
                } else {
                    // Tidak ada redirect
                    return {
                        redirects: [url],
                        finalUrl: url,
                        error: false
                    };
                }
                
            } catch (error) {
                // Jika fetch gagal, coba pendekatan lain
                // Di aplikasi nyata, Anda bisa menggunakan service worker atau proxy
                // Untuk demo, kita akan kembalikan error
                
                // Coba pendekatan dengan iframe untuk mengecek redirect
                return await checkRedirectWithIframe(url);
            }
        }
        
        // Metode alternatif untuk mengecek redirect menggunakan iframe
        function checkRedirectWithIframe(url) {
            return new Promise((resolve, reject) => {
                // Buat iframe tersembunyi
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = url;
                
                // Event listener untuk ketika iframe selesai memuat
                iframe.onload = function() {
                    try {
                        // Dapatkan URL akhir dari iframe
                        const finalUrl = iframe.contentWindow.location.href;
                        
                        resolve({
                            redirects: [url, finalUrl],
                            finalUrl: finalUrl,
                            error: false
                        });
                        
                        // Hapus iframe
                        document.body.removeChild(iframe);
                    } catch (e) {
                        // Jika tidak bisa membaca URL karena CORS
                        resolve({
                            redirects: [url],
                            finalUrl: url,
                            error: true,
                            errorMessage: 'Tidak dapat membaca redirect karena kebijakan keamanan'
                        });
                        
                        // Hapus iframe
                        document.body.removeChild(iframe);
                    }
                };
                
                iframe.onerror = function() {
                    reject(new Error('Gagal memuat link'));
                    document.body.removeChild(iframe);
                };
                
                // Tambahkan iframe ke body
                document.body.appendChild(iframe);
                
                // Timeout setelah 10 detik
                setTimeout(() => {
                    if (document.body.contains(iframe)) {
                        document.body.removeChild(iframe);
                        reject(new Error('Timeout: Link tidak merespons'));
                    }
                }, 10000);
            });
        }
        
        // Fungsi untuk menampilkan hasil
        function displayResults() {
            if (linkResults.length === 0) {
                showNoResults();
                return;
            }
            
            noResults.style.display = 'none';
            
            let html = '';
            
            linkResults.forEach((result, index) => {
                const hasRedirect = result.redirects && result.redirects.length > 1;
                const isError = result.error;
                
                html += `
                <div class="result-item">
                    <div class="original-link">
                        <span class="step-number">${index + 1}</span>
                        ${result.original}
                    </div>
                    
                    <div style="margin-top: 10px;">
                        ${isError ? 
                            `<span class="status-badge status-error">Error</span>` : 
                            hasRedirect ? 
                            `<span class="status-badge status-redirect">${result.redirects.length-1} Redirect</span>` :
                            `<span class="status-badge status-direct">Direct</span>`
                        }
                        <span style="font-size: 0.9rem; color: #666;">‚Üí ${result.finalUrl.replace('https://', '').replace('http://', '')}</span>
                    </div>
                    
                    ${hasRedirect || isError ? `
                    <div class="redirect-info">
                        ${result.redirects.map((step, stepIndex) => {
                            const isFinal = stepIndex === result.redirects.length - 1;
                            const isFirst = stepIndex === 0;
                            let stepClass = '';
                            let stepDisplay = step.replace('https://', '').replace('http://', '');
                            
                            if (isError && isFinal) {
                                stepClass = 'error';
                                stepDisplay += ` (${result.errorMessage || 'Error'})`;
                            } else if (isFinal) {
                                stepClass = 'final';
                            }
                            
                            return `<div class="redirect-step ${stepClass}">${stepDisplay}</div>`;
                        }).join('')}
                    </div>
                    ` : ''}
                </div>
                `;
            });
            
            resultsContainer.innerHTML = html;
        }
        
        // Fungsi untuk memperbarui statistik
        function updateStats() {
            const total = linkResults.length;
            const direct = linkResults.filter(r => !r.error && r.redirects && r.redirects.length === 1).length;
            const redirect = linkResults.filter(r => !r.error && r.redirects && r.redirects.length > 1).length;
            const error = linkResults.filter(r => r.error).length;
            
            totalLinksEl.textContent = total;
            directLinksEl.textContent = direct;
            redirectLinksEl.textContent = redirect;
            errorLinksEl.textContent = error;
            
            // Tampilkan statistik hanya jika ada hasil
            statsBar.style.display = total > 0 ? 'flex' : 'none';
        }
        
        // Fungsi untuk menampilkan loading
        function showLoading() {
            loading.style.display = 'block';
            noResults.style.display = 'none';
        }
        
        // Fungsi untuk menyembunyikan loading
        function hideLoading() {
            loading.style.display = 'none';
        }
        
        // Fungsi untuk menampilkan pesan tidak ada hasil
        function showNoResults() {
            noResults.style.display = 'block';
            resultsContainer.innerHTML = '';
            statsBar.style.display = 'none';
        }
        
        // Fungsi untuk menghapus semua hasil
        function clearResults() {
            if (confirm('Apakah Anda yakin ingin menghapus semua hasil?')) {
                linkInput.value = '';
                linkResults = [];
                showNoResults();
                updateStats();
            }
        }
        
        // Proses link secara otomatis saat halaman dimuat
        window.addEventListener('DOMContentLoaded', function() {
            // Jika ada isi di textarea, proses secara otomatis
            if (linkInput.value.trim()) {
                setTimeout(processLinks, 500);
            }
        });
    </script>
</body>
</html>
