<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Memo & Reportan - Database Cloud</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            display: flex;
            min-height: 100vh;
            background: linear-gradient(135deg, #f8f6ff 0%, #f0edff 100%);
            color: #333;
            transition: all 0.3s ease;
        }
        
        /* Sidebar Menu - Diperlebar dengan warna biru keunguan */
        .sidebar {
            width: 320px;
            background: linear-gradient(180deg, #5d3fd3 0%, #3a1f8c 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Sidebar Minimized State */
        .sidebar.minimized {
            width: 80px;
        }
        
        .sidebar.minimized .logo h2 {
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .sidebar.minimized .logo-text,
        .sidebar.minimized .logo p,
        .sidebar.minimized .category-title,
        .sidebar.minimized .menu-item span,
        .sidebar.minimized .menu-item-arrow,
        .sidebar.minimized .memo-count,
        .sidebar.minimized .submenu-item span,
        .sidebar.minimized .submenu,
        .sidebar.minimized .minimize-text,
        .sidebar.minimized .api-status {
            display: none;
        }
        
        .sidebar.minimized .menu-item {
            padding: 18px 15px;
            justify-content: center;
        }
        
        .sidebar.minimized .menu-item-content {
            justify-content: center;
            gap: 0;
        }
        
        .sidebar.minimized .menu-item i {
            font-size: 1.5rem;
            width: auto;
        }
        
        .sidebar.minimized .logo h2 i {
            margin: 0;
        }
        
        /* Tombol Minimize - Posisi di atas Kategori Utama */
        .minimize-btn-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 25px 10px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
            margin-bottom: 15px;
        }
        
        .minimize-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .minimize-label i {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .minimize-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }
        
        .minimize-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.2) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }
        
        .minimize-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.15) rotate(5deg);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .minimize-btn:hover::before {
            transform: translateX(100%);
        }
        
        .minimize-btn:active {
            transform: scale(0.95) rotate(-5deg);
            transition: all 0.1s;
        }
        
        .sidebar.minimized .minimize-btn {
            transform: rotate(180deg);
        }
        
        .sidebar.minimized .minimize-btn:hover {
            transform: rotate(180deg) scale(1.15);
        }
        
        .sidebar.minimized .minimize-btn:active {
            transform: rotate(180deg) scale(0.95);
        }
        
        .logo {
            text-align: center;
            padding: 20px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
            margin-bottom: 20px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .logo h2 {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.8rem;
            color: white;
            transition: all 0.3s ease;
        }
        
        .logo-text {
            transition: opacity 0.3s ease;
        }
        
        /* Status Koneksi API */
        .api-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            margin: 10px 25px;
            border-radius: 10px;
            font-size: 0.85rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .api-status.online {
            background: rgba(46, 204, 113, 0.2);
            border-color: rgba(46, 204, 113, 0.3);
        }
        
        .api-status.offline {
            background: rgba(231, 76, 60, 0.2);
            border-color: rgba(231, 76, 60, 0.3);
        }
        
        .api-status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #95a5a6;
        }
        
        .api-status-dot.online {
            background-color: #2ecc71;
            box-shadow: 0 0 8px #2ecc71;
            animation: pulseDot 2s infinite;
        }
        
        .api-status-dot.offline {
            background-color: #e74c3c;
            box-shadow: 0 0 8px #e74c3c;
        }
        
        .category-title {
            padding: 12px 25px;
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
        }
        
        .menu-item {
            padding: 18px 25px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 1.05rem;
            color: white;
            position: relative;
        }
        
        .menu-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-left-color: #8a2be2;
        }
        
        .menu-item.active {
            background-color: rgba(138, 43, 226, 0.2);
            border-left-color: #8a2be2;
            color: white;
        }
        
        .menu-item-content {
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
            transition: all 0.3s ease;
        }
        
        .menu-item i {
            font-size: 1.3rem;
            width: 28px;
            text-align: center;
            color: white;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        .menu-item-arrow {
            transition: all 0.3s;
            font-size: 1rem;
            opacity: 0.7;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .menu-item-arrow.rotated {
            transform: rotate(180deg);
        }
        
        .submenu {
            display: none;
            padding-left: 35px;
            background-color: rgba(255, 255, 255, 0.05);
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            max-height: 0;
        }
        
        .submenu.expanded {
            display: block;
            max-height: 500px;
        }
        
        .submenu-item {
            padding: 14px 25px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid transparent;
            font-size: 0.95rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }
        
        .submenu-item:hover {
            background-color: rgba(255, 255, 255, 0.08);
            border-left-color: #2ecc71;
        }
        
        .submenu-item.active {
            background-color: rgba(46, 204, 113, 0.2);
            border-left-color: #2ecc71;
            color: white;
        }
        
        .submenu-item i {
            color: white;
        }
        
        .memo-count {
            background-color: #8a2be2;
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: bold;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        /* Konten Utama */
        .main-content {
            flex: 1;
            margin-left: 320px;
            padding: 40px;
            max-width: none;
            width: calc(100% - 320px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .sidebar.minimized ~ .main-content {
            margin-left: 80px;
            width: calc(100% - 80px);
        }
        
        /* HEADER dengan tema biru keunguan */
        .header {
            margin-bottom: 30px;
            padding: 30px 40px;
            border-radius: 15px 15px 0 0;
            background: linear-gradient(135deg, #5d3fd3 0%, #3a1f8c 100%);
            box-shadow: 0 8px 20px rgba(93, 63, 211, 0.2);
            position: relative;
            overflow: hidden;
            border-left: 5px solid #ffd700;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
            transition: all 0.3s ease;
        }
        
        .sidebar.minimized ~ .main-content .header {
            padding: 30px 30px;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
            animation: shine 3s infinite;
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 1;
            width: 100%;
        }
        
        .header h1 {
            color: white;
            font-size: 3rem;
            font-weight: 800;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            letter-spacing: 1.5px;
            position: relative;
            z-index: 1;
            margin: 15px 0;
            text-align: center;
            width: 100%;
            transition: all 0.3s ease;
        }
        
        .sidebar.minimized ~ .main-content .header h1 {
            font-size: 2.5rem;
        }
        
        .header p {
            color: rgba(255, 255, 255, 0.9);
            margin-top: 10px;
            font-size: 1.3rem;
            position: relative;
            z-index: 1;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            text-align: center;
            width: 100%;
            max-width: 800px;
            transition: all 0.3s ease;
        }
        
        .sidebar.minimized ~ .main-content .header p {
            font-size: 1.1rem;
        }
        
        .header-icon {
            background: rgba(255, 255, 255, 0.2);
            width: 85px;
            height: 85px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            border: 3px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .sidebar.minimized ~ .main-content .header-icon {
            width: 70px;
            height: 70px;
            font-size: 2rem;
        }
        
        /* BAR INFORMASI DI BAWAH HEADER - GRID 3 KOLOM SAMA BESAR dengan tema biru keunguan */
        .info-bar {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px 35px;
            background: white;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 8px 25px rgba(93, 63, 211, 0.1);
            border: 1px solid #e9ecef;
            border-top: none;
            position: relative;
            z-index: 5;
            min-height: 90px;
            gap: 20px;
            width: 100%;
            transition: all 0.3s ease;
        }
        
        .sidebar.minimized ~ .main-content .info-bar {
            padding: 20px 25px;
        }
        
        /* Semua kolom memiliki ukuran yang sama */
        .info-left, .info-center, .info-right {
            display: flex;
            height: 100%;
            align-items: center;
            justify-content: center;
        }
        
        /* STYLE UNTUK KOTAK TANGGAL, JAM & NETWORK CHECKER DENGAN ANIMASI GRADIENT DI DALAM */
        .date-container, .clock-container, .network-checker {
            position: relative;
            background: white;
            border-radius: 15px;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            min-width: 240px;
            z-index: 1;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        /* Gradient background yang berputar di dalam */
        .date-container::before, .clock-container::before, .network-checker::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                #ff0000, #ff9900, #ffff00, #00ff00, 
                #0099ff, #6600ff, #ff00ff, #ff0000);
            background-size: 400% 400%;
            z-index: 1;
            animation: gradientRotate 3s linear infinite;
            border-radius: 15px;
        }
        
        /* Konten di atas gradient */
        .date-content, .clock-content, .network-content {
            position: relative;
            background: white;
            border-radius: 12px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            height: 100%;
            z-index: 2;
        }
        
        /* Animasi untuk gradient berputar */
        @keyframes gradientRotate {
            0% {
                background-position: 0% 50%;
                transform: rotate(0deg);
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
                transform: rotate(360deg);
            }
        }
        
        /* Efek hover */
        .date-container:hover, .clock-container:hover, .network-checker:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        /* Style untuk teks di dalam (rata tengah) */
        .date-text, .clock-text {
            font-weight: 600;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            letter-spacing: 0.3px;
            flex: 1;
        }
        
        /* Font khusus untuk tanggal - Orbitron */
        .date-text {
            font-family: 'Orbitron', sans-serif;
            color: #2c3e50;
            font-size: clamp(14px, 1.6vw, 18px);
            font-weight: 600;
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
        }
        
        /* Font khusus untuk jam digital - Share Tech Mono dengan efek kedip halus */
        .clock-text {
            font-family: 'Share Tech Mono', monospace;
            font-size: clamp(22px, 2.4vw, 32px);
            font-weight: 700;
            letter-spacing: 1.5px;
            color: #5d3fd3;
            text-shadow: 0 2px 4px rgba(93, 63, 211, 0.3);
            animation: gentleBlink 4s infinite;
        }
        
        /* Animasi kedip halus untuk jam */
        @keyframes gentleBlink {
            0%, 100% {
                opacity: 1;
                text-shadow: 0 0 5px rgba(93, 63, 211, 0.5);
            }
            50% {
                opacity: 0.9;
                text-shadow: 0 0 10px rgba(93, 63, 211, 0.8);
            }
        }
        
        /* Icon juga diatur agar ikut rata tengah */
        .date-icon, .clock-icon, .network-icon {
            color: #5d3fd3;
            font-size: clamp(18px, 1.8vw, 24px);
            min-width: 32px;
            flex-shrink: 0;
        }
        
        .clock-icon {
            color: #3a1f8c;
        }
        
        /* Network checker specific styles */
        .network-checker {
            cursor: pointer;
        }
        
        .network-status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #95a5a6;
            transition: all 0.3s;
            flex-shrink: 0;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }
        
        .network-status-dot.online {
            background-color: #2ecc71;
            box-shadow: 0 0 10px #2ecc71;
            animation: pulseDot 2s infinite;
        }
        
        .network-status-dot.slow {
            background-color: #f39c12;
            box-shadow: 0 0 10px #f39c12;
            animation: pulseDot 2s infinite;
        }
        
        .network-status-dot.offline {
            background-color: #e74c3c;
            box-shadow: 0 0 10px #e74c3c;
            animation: pulseDot 2s infinite;
        }
        
        @keyframes pulseDot {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        /* Font khusus untuk ping - Share Tech Mono */
        .network-ping {
            font-family: 'Share Tech Mono', monospace;
            font-weight: 700;
            color: #2c3e50;
            min-width: 60px;
            text-align: center;
            font-size: clamp(16px, 1.7vw, 20px);
            letter-spacing: 0.5px;
        }
        
        .network-result {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 10px;
            background: white;
            color: #2c3e50;
            padding: 20px 25px;
            border-radius: 15px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
            min-width: 250px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s;
            pointer-events: none;
            z-index: 10;
            border: 1px solid #e0e0e0;
        }
        
        .network-result.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }
        
        .network-result::before {
            content: '';
            position: absolute;
            top: -10px;
            right: 20px;
            width: 20px;
            height: 20px;
            background: white;
            transform: rotate(45deg);
            border-left: 1px solid #e0e0e0;
            border-top: 1px solid #e0e0e0;
            z-index: -1;
        }
        
        .network-result-title {
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .network-result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }
        
        .network-result-label {
            color: #7f8c8d;
        }
        
        .network-result-value {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .network-latency {
            color: #2c3e50;
        }
        
        .network-status {
            padding: 5px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 700;
            display: inline-block;
        }
        
        .network-status-online {
            background-color: #d5f4e6;
            color: #27ae60;
            border: 1px solid #2ecc71;
        }
        
        .network-status-slow {
            background-color: #fef9e7;
            color: #f39c12;
            border: 1px solid #f39c12;
        }
        
        .network-status-offline {
            background-color: #fdeaea;
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }
        
        .network-loading {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* Form Container dengan tema biru keunguan */
        .form-container {
            background: linear-gradient(135deg, #6a4fdb 0%, #4a2fa8 100%);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(93, 63, 211, 0.2);
            margin-bottom: 40px;
            animation: fadeIn 0.5s;
            margin-top: 20px;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .sidebar.minimized ~ .main-content .form-container {
            padding: 30px;
        }
        
        .form-title {
            margin-bottom: 30px;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            font-size: 1.5rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            font-size: 1.05rem;
            transition: all 0.3s;
            color: white;
        }
        
        input::placeholder, textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.15);
        }
        
        textarea {
            min-height: 220px;
            resize: vertical;
            line-height: 1.6;
        }
        
        select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 20px;
            padding-right: 50px;
        }
        
        option {
            background-color: #4a2fa8;
            color: white;
        }
        
        .btn {
            background: linear-gradient(135deg, #8a2be2 0%, #6a0dad 100%);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 4px 15px rgba(138, 43, 226, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(138, 43, 226, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-reset {
            background: rgba(255, 255, 255, 0.2);
            margin-left: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-reset:hover {
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.2);
        }
        
        /* Notifikasi */
        .notification {
            position: fixed;
            top: 25px;
            right: 25px;
            background: linear-gradient(135deg, #6a4fdb 0%, #4a2fa8 100%);
            color: white;
            padding: 18px 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s;
            font-size: 1.05rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Data Tersimpan dengan tema biru keunguan untuk semua subkategori */
        .data-container {
            background: linear-gradient(135deg, #6a4fdb 0%, #4a2fa8 100%);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(93, 63, 211, 0.2);
            margin-top: 30px;
            animation: fadeIn 0.5s;
            display: none;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s ease;
        }
        
        .sidebar.minimized ~ .main-content .data-container {
            padding: 30px;
        }
        
        .data-container.active {
            display: block;
        }
        
        .data-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .data-header h3 {
            font-size: 1.4rem;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        /* Search Container dengan tema biru keunguan */
        .search-container {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.1);
            padding: 18px;
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .sidebar.minimized ~ .main-content .search-container {
            padding: 15px;
        }
        
        .search-box {
            flex: 1;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 16px 20px 16px 60px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            font-size: 1.05rem;
            transition: all 0.3s;
            color: white;
        }
        
        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .search-input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 1.3rem;
        }
        
        .search-info {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.9);
            background: rgba(255, 255, 255, 0.15);
            padding: 10px 15px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .search-clear {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }
        
        .search-clear:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(255, 255, 255, 0.1);
        }
        
        /* Data Grid */
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            transition: all 0.3s ease;
        }
        
        .sidebar.minimized ~ .main-content .data-grid {
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .data-item {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 25px;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }
        
        .data-item:hover {
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            transform: translateY(-5px);
            border-color: rgba(255, 255, 255, 0.4);
        }
        
        /* Kategori Memo dengan warna berbeda-beda */
        .data-category {
            display: inline-block;
            background: linear-gradient(135deg, #8a2be2 0%, #6a0dad 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 12px;
            box-shadow: 0 2px 5px rgba(138, 43, 226, 0.3);
        }
        
        /* Subkategori dengan variasi warna biru keunguan */
        .data-subcategory {
            display: inline-block;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 12px;
            margin-left: 8px;
            box-shadow: 0 2px 5px rgba(255, 255, 255, 0.1);
        }
        
        /* Warna berbeda untuk setiap subkategori memo */
        .data-subcategory[data-subcategory="MEMO PEMBAGIAN BONUS"] {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        }
        
        .data-subcategory[data-subcategory="MEMO INFORMASI BANK"] {
            background: linear-gradient(135deg, #48dbfb 0%, #0abde3 100%);
        }
        
        .data-subcategory[data-subcategory="MEMO KENDALA PERMAINAN"] {
            background: linear-gradient(135deg, #1dd1a1 0%, #10ac84 100%);
        }
        
        .data-subcategory[data-subcategory="MEMO KENDALA SISTEM"] {
            background: linear-gradient(135deg, #f368e0 0%, #ff9ff3 100%);
        }
        
        .data-title {
            font-weight: 700;
            margin-bottom: 12px;
            color: white;
            font-size: 1.2rem;
        }
        
        .data-content {
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 18px;
            line-height: 1.6;
            max-height: 140px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 4;
            -webkit-box-orient: vertical;
        }
        
        .data-date {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .empty-data {
            text-align: center;
            padding: 50px 20px;
            color: rgba(255, 255, 255, 0.8);
            grid-column: 1 / -1;
        }
        
        .empty-data i {
            font-size: 3.5rem;
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.5);
        }
        
        .empty-data h3 {
            font-size: 1.4rem;
            margin-bottom: 10px;
        }
        
        .empty-data p {
            font-size: 1.05rem;
        }
        
        .highlight {
            background-color: rgba(255, 255, 255, 0.3);
            padding: 3px 5px;
            border-radius: 3px;
            color: #ffd700;
            font-weight: 600;
        }
        
        /* Loading Spinner */
        .loading-spinner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
        }
        
        .loading-spinner.active {
            display: block;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 6px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #5d3fd3;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Modal untuk setting API */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .modal-header h3 {
            color: #2c3e50;
            font-size: 1.4rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #7f8c8d;
            cursor: pointer;
        }
        
        .modal-body {
            margin-bottom: 25px;
        }
        
        /* Animasi */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Tombol Toggle Sidebar untuk Mobile */
        .toggle-sidebar {
            display: none;
            position: fixed;
            top: 25px;
            left: 25px;
            background: linear-gradient(135deg, #6a4fdb 0%, #4a2fa8 100%);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 10px;
            z-index: 101;
            font-size: 1.8rem;
            box-shadow: 0 4px 15px rgba(93, 63, 211, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Responsif */
        @media (max-width: 1200px) {
            .sidebar {
                width: 300px;
            }
            
            .sidebar.minimized {
                width: 80px;
            }
            
            .main-content {
                margin-left: 300px;
                padding: 30px;
                width: calc(100% - 300px);
            }
            
            .sidebar.minimized ~ .main-content {
                margin-left: 80px;
                width: calc(100% - 80px);
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .sidebar.minimized ~ .main-content .header h1 {
                font-size: 2.2rem;
            }
            
            .data-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
            
            .sidebar.minimized ~ .main-content .data-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }
        
        @media (max-width: 992px) {
            .sidebar {
                width: 280px;
                transform: translateX(-100%);
            }
            
            .sidebar.show {
                transform: translateX(0);
            }
            
            .sidebar.minimized {
                width: 280px;
                transform: translateX(-100%);
            }
            
            .sidebar.minimized.show {
                transform: translateX(0);
                width: 280px;
            }
            
            .sidebar.minimized .logo h2 {
                justify-content: flex-start;
            }
            
            .sidebar.minimized .logo-text,
            .sidebar.minimized .logo p,
            .sidebar.minimized .category-title,
            .sidebar.minimized .menu-item span,
            .sidebar.minimized .menu-item-arrow,
            .sidebar.minimized .memo-count,
            .sidebar.minimized .submenu-item span,
            .sidebar.minimized .submenu,
            .sidebar.minimized .minimize-text,
            .sidebar.minimized .api-status {
                display: block;
            }
            
            .sidebar.minimized .menu-item {
                padding: 18px 25px;
                justify-content: space-between;
            }
            
            .sidebar.minimized .menu-item-content {
                justify-content: flex-start;
                gap: 15px;
            }
            
            .sidebar.minimized .menu-item i {
                font-size: 1.3rem;
                width: 28px;
            }
            
            .sidebar.minimized .minimize-btn {
                transform: none;
            }
            
            .sidebar.minimized .minimize-btn:hover {
                transform: scale(1.1);
            }
            
            .main-content {
                margin-left: 0;
                padding: 25px;
                width: 100%;
            }
            
            .sidebar.minimized ~ .main-content {
                margin-left: 0;
                width: 100%;
            }
            
            .toggle-sidebar {
                display: block;
            }
            
            .data-grid {
                grid-template-columns: 1fr;
            }
            
            .header {
                margin-bottom: 30px;
                padding: 25px;
                min-height: 180px;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .sidebar.minimized ~ .main-content .header h1 {
                font-size: 2.2rem;
            }
            
            .header-icon {
                width: 70px;
                height: 70px;
                font-size: 2rem;
            }
            
            .sidebar.minimized ~ .main-content .header-icon {
                width: 70px;
                height: 70px;
                font-size: 2rem;
            }
            
            .search-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-info {
                order: 3;
                text-align: center;
                justify-content: center;
            }
            
            .search-clear {
                order: 2;
                justify-content: center;
            }
            
            .info-bar {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 15px;
            }
            
            .info-left, .info-center, .info-right {
                justify-content: center;
                width: 100%;
            }
            
            .date-container, .clock-container, .network-checker {
                width: 100%;
                max-width: 350px;
                justify-content: center;
            }
            
            .date-text, .clock-text {
                white-space: normal;
                text-align: center;
            }
            
            .form-container, .data-container {
                padding: 30px;
            }
            
            .sidebar.minimized ~ .main-content .form-container,
            .sidebar.minimized ~ .main-content .data-container {
                padding: 30px;
            }
        }
        
        @media (max-width: 768px) {
            .btn-reset {
                margin-left: 0;
                margin-top: 15px;
            }
            
            .form-container {
                padding: 25px;
            }
            
            .header {
                padding: 20px;
                min-height: 160px;
            }
            
            .header h1 {
                font-size: 1.9rem;
            }
            
            .sidebar.minimized ~ .main-content .header h1 {
                font-size: 1.9rem;
            }
            
            .header-icon {
                width: 60px;
                height: 60px;
                font-size: 1.8rem;
            }
            
            .sidebar.minimized ~ .main-content .header-icon {
                width: 60px;
                height: 60px;
                font-size: 1.8rem;
            }
            
            .header p {
                font-size: 1.1rem;
            }
            
            .sidebar.minimized ~ .main-content .header p {
                font-size: 1.1rem;
            }
            
            .data-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .data-header > div {
                width: 100%;
                display: flex;
                justify-content: space-between;
            }
            
            .info-bar {
                margin-bottom: 25px;
            }
            
            .network-result {
                min-width: 200px;
                right: -50px;
            }
            
            .network-result::before {
                right: 30px;
            }
            
            .date-container, .clock-container, .network-checker {
                min-width: 200px;
            }
            
            .date-content, .clock-content, .network-content {
                padding: 10px 15px;
            }
            
            .clock-text {
                font-size: clamp(20px, 2.2vw, 28px);
            }
        }
        
        @media (max-width: 480px) {
            .header {
                padding: 15px;
                min-height: 140px;
            }
            
            .header h1 {
                font-size: 1.7rem;
            }
            
            .sidebar.minimized ~ .main-content .header h1 {
                font-size: 1.7rem;
            }
            
            .header-icon {
                width: 55px;
                height: 55px;
                font-size: 1.6rem;
            }
            
            .sidebar.minimized ~ .main-content .header-icon {
                width: 55px;
                height: 55px;
                font-size: 1.6rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .sidebar.minimized ~ .main-content .header p {
                font-size: 1rem;
            }
            
            .form-container, .data-container {
                padding: 20px;
            }
            
            .sidebar.minimized ~ .main-content .form-container,
            .sidebar.minimized ~ .main-content .data-container {
                padding: 20px;
            }
            
            .network-result {
                right: -80px;
                min-width: 180px;
            }
            
            .network-result::before {
                right: 40px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .sidebar.minimized ~ .main-content {
                padding: 20px;
            }
            
            .date-container, .clock-container, .network-checker {
                padding: 3px;
                min-width: auto;
            }
            
            .date-content, .clock-content, .network-content {
                padding: 8px 12px;
                gap: 8px;
            }
            
            .date-text {
                font-size: 14px;
            }
            
            .clock-text {
                font-size: 18px;
            }
            
            .network-ping {
                font-size: 16px;
            }
            
            .date-icon, .clock-icon, .network-icon {
                font-size: 16px;
                min-width: 25px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
    </div>
    
    <!-- Tombol Toggle Sidebar untuk Mobile -->
    <button class="toggle-sidebar" id="toggleSidebar">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar Menu dengan warna biru keunguan -->
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <h2><i class="fas fa-sticky-note"></i> <span class="logo-text">Memo & Reportan</span></h2>
            <p style="font-size: 0.9rem; opacity: 0.7; margin-top: 5px;">Database Cloud - Spreadsheet Anda</p>
        </div>
        
        <!-- Tombol Minimize di atas Kategori Utama -->
        <div class="minimize-btn-container">
            <div class="minimize-label">
                <i class="fas fa-compress-alt"></i>
                <span class="minimize-text">Minimize</span>
            </div>
            <button class="minimize-btn" id="minimizeBtn" title="Minimize Sidebar">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <!-- Status Koneksi Database -->
        <div class="api-status online" id="apiStatus">
            <div class="api-status-dot online" id="apiStatusDot"></div>
            <span id="apiStatusText">Terhubung ke Spreadsheet Anda</span>
        </div>
        
        <div class="category-title">Kategori Utama</div>
        
        <!-- Menu MEMO dengan arrow untuk collapse/expand -->
        <div class="menu-item active" data-category="memo" id="mainMenuMemo">
            <div class="menu-item-content">
                <i class="fas fa-envelope"></i>
                <span>MEMO</span>
            </div>
            <div class="menu-item-arrow" id="memoArrow">
                <i class="fas fa-chevron-down"></i>
            </div>
        </div>
        
        <!-- Submenu untuk Memo -->
        <div class="submenu expanded" id="memoSubmenu">
            <div class="submenu-item" data-subcategory="MEMO PEMBAGIAN BONUS">
                <span><i class="fas fa-gift"></i> PEMBAGIAN BONUS</span>
                <div class="memo-count" id="bonusCount">0</div>
            </div>
            <div class="submenu-item" data-subcategory="MEMO INFORMASI BANK">
                <span><i class="fas fa-university"></i> INFORMASI BANK</span>
                <div class="memo-count" id="bankCount">0</div>
            </div>
            <div class="submenu-item" data-subcategory="MEMO KENDALA PERMAINAN">
                <span><i class="fas fa-gamepad"></i> KENDALA PERMAINAN</span>
                <div class="memo-count" id="permainanCount">0</div>
            </div>
            <div class="submenu-item" data-subcategory="MEMO KENDALA SISTEM">
                <span><i class="fas fa-server"></i> KENDALA SISTEM</span>
                <div class="memo-count" id="sistemCount">0</div>
            </div>
        </div>
        
        <div class="menu-item" data-category="reportan">
            <div class="menu-item-content">
                <i class="fas fa-file-alt"></i>
                <span>Reportan</span>
            </div>
            <div class="memo-count" id="reportanCount">0</div>
        </div>
        
        <!-- Link ke Spreadsheet -->
        <div class="menu-item" id="viewSpreadsheet">
            <div class="menu-item-content">
                <i class="fas fa-external-link-alt"></i>
                <span>Lihat Spreadsheet</span>
            </div>
        </div>
    </div>
    
    <!-- Konten Utama -->
    <div class="main-content">
        <!-- HEADER dengan tema biru keunguan -->
        <div class="header">
            <div class="header-content">
                <div class="header-icon">
                    <i class="fas fa-sticky-note" id="headerIcon"></i>
                </div>
                <h1 id="pageTitle">MEMO LINE</h1>
                <p id="pageSubtitle">Database Cloud - Data Tersimpan di Spreadsheet Anda</p>
            </div>
        </div>
        
        <!-- BAR INFORMASI DI BAWAH HEADER - GRID 3 KOLOM SAMA BESAR dengan animasi gradient di dalam -->
        <div class="info-bar">
            <!-- Kolom Kiri - Tanggal (align-center) -->
            <div class="info-left">
                <div class="date-container">
                    <div class="date-content">
                        <i class="fas fa-calendar-alt date-icon"></i>
                        <span class="date-text" id="currentDate">Senin, 29 Desember 2025</span>
                    </div>
                </div>
            </div>
            
            <!-- Kolom Tengah - Jam Digital (align-center) -->
            <div class="info-center">
                <div class="clock-container">
                    <div class="clock-content">
                        <i class="fas fa-clock clock-icon"></i>
                        <span class="clock-text" id="digitalClock">14:32:09</span>
                    </div>
                </div>
            </div>
            
            <!-- Kolom Kanan - Network Checker (align-center) -->
            <div class="info-right">
                <div class="network-container">
                    <div class="network-checker" id="networkChecker">
                        <div class="network-content">
                            <i class="fas fa-wifi network-icon" id="networkIcon"></i>
                            <div class="network-status-dot" id="networkStatusDot"></div>
                            <span class="network-ping" id="networkPing">-</span>
                        </div>
                    </div>
                    
                    <!-- Network Result Popup -->
                    <div class="network-result" id="networkResult">
                        <div class="network-result-title">
                            <i class="fas fa-network-wired"></i>
                            Status Jaringan
                        </div>
                        <div class="network-result-item">
                            <span class="network-result-label">Latensi:</span>
                            <span class="network-result-value network-latency" id="networkLatency">-</span>
                        </div>
                        <div class="network-result-item">
                            <span class="network-result-label">Status:</span>
                            <span class="network-result-value">
                                <span class="network-status" id="networkStatus">Memeriksa...</span>
                            </span>
                        </div>
                        <div class="network-result-item">
                            <span class="network-result-label">Server:</span>
                            <span class="network-result-value">google.com</span>
                        </div>
                        <div class="network-result-item">
                            <span class="network-result-label">Terakhir diperiksa:</span>
                            <span class="network-result-value" id="networkLastChecked">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Form Memo dengan tema biru keunguan -->
        <div class="form-container" id="memoForm">
            <h3 class="form-title"><i class="fas fa-edit"></i> Form Tambah Memo Baru</h3>
            <form id="memoFormData">
                <div class="form-group">
                    <label for="memoJudul"><i class="fas fa-heading"></i> Judul Memo</label>
                    <input type="text" id="memoJudul" placeholder="Contoh: INFORMASI BONUS CASHBACK KEKALAHAN 5% (SLOT GAMES & E-LOTTERY)" required>
                </div>
                
                <div class="form-group">
                    <label for="memoIsi"><i class="fas fa-edit"></i> Isi / Memo</label>
                    <textarea id="memoIsi" placeholder="Tulis isi memo di sini..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="memoSubcategory"><i class="fas fa-tag"></i> Subkategori Memo</label>
                    <select id="memoSubcategory" required>
                        <option value="">Pilih Subkategori</option>
                        <option value="MEMO PEMBAGIAN BONUS">MEMO PEMBAGIAN BONUS</option>
                        <option value="MEMO INFORMASI BANK">MEMO INFORMASI BANK</option>
                        <option value="MEMO KENDALA PERMAINAN">MEMO KENDALA PERMAINAN</option>
                        <option value="MEMO KENDALA SISTEM">MEMO KENDALA SISTEM</option>
                    </select>
                </div>
                
                <button type="submit" class="btn" id="tambahMemo">
                    <i class="fas fa-plus"></i> Simpan ke Spreadsheet
                </button>
                <button type="reset" class="btn btn-reset">
                    <i class="fas fa-redo"></i> Reset Form
                </button>
            </form>
            
            <!-- Info Spreadsheet -->
            <div class="form-group" style="margin-top: 30px; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 20px;">
                <label><i class="fas fa-database"></i> Info Database</label>
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-top: 10px;">
                    <p style="margin-bottom: 8px; font-size: 0.95rem;">
                        <i class="fas fa-check-circle" style="color: #2ecc71;"></i> 
                        <strong>Terhubung ke Spreadsheet Anda:</strong>
                    </p>
                    <p style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 5px;">
                        ID: <code style="background: rgba(0,0,0,0.2); padding: 2px 6px; border-radius: 4px;">1oirwkd74CMLvcfAIkBLn_UJJDhha8sJ7gN8FRhrlipw</code>
                    </p>
                    <p style="font-size: 0.85rem; opacity: 0.9;">
                        <i class="fas fa-external-link-alt"></i>
                        <a href="https://docs.google.com/spreadsheets/d/1oirwkd74CMLvcfAIkBLn_UJJDhha8sJ7gN8FRhrlipw/edit" target="_blank" style="color: #ffd700; text-decoration: none;">
                            Buka Spreadsheet di Tab Baru
                        </a>
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Data Tersimpan - HANYA DITAMPILKAN DI SUBKATEGORI -->
        <div class="data-container" id="dataContainer">
            <div class="data-header">
                <h3 id="dataTitle"><i class="fas fa-database"></i> Data Tersimpan</h3>
                <div>
                    <button class="btn" id="clearData" style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%); border: 1px solid rgba(255, 255, 255, 0.3); margin-right: 10px;">
                        <i class="fas fa-trash"></i> Hapus Semua
                    </button>
                    <button class="btn" id="refreshData" style="background: linear-gradient(135deg, rgba(46, 204, 113, 0.8) 0%, rgba(39, 174, 96, 0.8) 100%); border: 1px solid rgba(46, 204, 113, 0.3);">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
            </div>
            
            <!-- Container Pencarian -->
            <div class="search-container" id="searchContainer">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" class="search-input" placeholder="Cari memo berdasarkan kata kunci...">
                </div>
                <button class="search-clear" id="clearSearch">
                    <i class="fas fa-times"></i> Hapus Pencarian
                </button>
                <div class="search-info" id="searchInfo">
                    <i class="fas fa-info-circle"></i>
                    <span>Data diambil langsung dari Google Spreadsheet</span>
                </div>
            </div>
            
            <div class="data-grid" id="dataGrid">
                <div class="empty-data">
                    <i class="fas fa-cloud"></i>
                    <h3>Memuat data dari Spreadsheet...</h3>
                    <p>Data sedang dimuat dari Google Sheets Anda</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Notifikasi -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">Berhasil disimpan!</span>
    </div>

    <script>
        // ========== KONFIGURASI ==========
        const SPREADSHEET_ID = "1oirwkd74CMLvcfAIkBLn_UJJDhha8sJ7gN8FRhrlipw";
        const API_KEY = "AIzaSyB9q5Q7kQhT2QhQ2QhQ2QhQ2QhQ2QhQ2QhQ"; // API Key untuk Google Sheets API
        const API_URL = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/Sheet1?key=${API_KEY}`;
        const WRITE_API_URL = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/Sheet1:append?valueInputOption=USER_ENTERED&key=${API_KEY}`;
        const CLEAR_API_URL = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/Sheet1:clear?key=${API_KEY}`;
        
        // Data sementara untuk caching
        let savedData = JSON.parse(localStorage.getItem('memoReportanDataCache')) || [];
        
        // ========== ELEMEN DOM ==========
        const sidebar = document.getElementById('sidebar');
        const toggleSidebarBtn = document.getElementById('toggleSidebar');
        const menuItems = document.querySelectorAll('.menu-item');
        const mainMenuMemo = document.getElementById('mainMenuMemo');
        const memoArrow = document.getElementById('memoArrow');
        const memoSubmenu = document.getElementById('memoSubmenu');
        const submenuItems = document.querySelectorAll('.submenu-item');
        const pageTitle = document.getElementById('pageTitle');
        const pageSubtitle = document.getElementById('pageSubtitle');
        const headerIcon = document.getElementById('headerIcon');
        const memoForm = document.getElementById('memoForm');
        const memoSubcategorySelect = document.getElementById('memoSubcategory');
        const memoFormData = document.getElementById('memoFormData');
        const memoJudulInput = document.getElementById('memoJudul');
        const memoIsiInput = document.getElementById('memoIsi');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notificationText');
        const dataContainer = document.getElementById('dataContainer');
        const dataGrid = document.getElementById('dataGrid');
        const dataTitle = document.getElementById('dataTitle');
        const clearDataBtn = document.getElementById('clearData');
        const refreshDataBtn = document.getElementById('refreshData');
        const searchContainer = document.getElementById('searchContainer');
        const searchInput = document.getElementById('searchInput');
        const clearSearchBtn = document.getElementById('clearSearch');
        const searchInfo = document.getElementById('searchInfo');
        const minimizeBtn = document.getElementById('minimizeBtn');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const viewSpreadsheetBtn = document.getElementById('viewSpreadsheet');
        const apiStatus = document.getElementById('apiStatus');
        const apiStatusDot = document.getElementById('apiStatusDot');
        const apiStatusText = document.getElementById('apiStatusText');
        
        // Elemen tanggal dan jam
        const currentDateElement = document.getElementById('currentDate');
        const digitalClockElement = document.getElementById('digitalClock');
        
        // Network checker elements
        const networkChecker = document.getElementById('networkChecker');
        const networkIcon = document.getElementById('networkIcon');
        const networkStatusDot = document.getElementById('networkStatusDot');
        const networkPing = document.getElementById('networkPing');
        const networkResult = document.getElementById('networkResult');
        const networkLatency = document.getElementById('networkLatency');
        const networkStatus = document.getElementById('networkStatus');
        const networkLastChecked = document.getElementById('networkLastChecked');
        
        // Counter elements
        const bonusCount = document.getElementById('bonusCount');
        const bankCount = document.getElementById('bankCount');
        const permainanCount = document.getElementById('permainanCount');
        const sistemCount = document.getElementById('sistemCount');
        const reportanCount = document.getElementById('reportanCount');
        
        // ========== VARIABEL GLOBAL ==========
        let activeCategory = 'memo';
        let activeSubcategory = '';
        let isMainPage = true;
        let currentSearchKeyword = '';
        let isMemoSubmenuExpanded = true;
        let networkResultVisible = false;
        let lastNetworkCheckTime = null;
        let isSidebarMinimized = localStorage.getItem('sidebarMinimized') === 'true';
        
        // ========== FUNGSI UTILITAS ==========
        
        // Fungsi untuk memperbarui tanggal
        function updateDateDisplay() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            const formattedDate = now.toLocaleDateString('id-ID', options);
            currentDateElement.textContent = formattedDate;
        }
        
        // Fungsi untuk memperbarui jam digital dengan efek kedip
        function updateClock() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            digitalClockElement.textContent = `${hours}:${minutes}:${seconds}`;
        }
        
        // Format tanggal untuk data
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', {
                day: 'numeric',
                month: 'long',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // Format waktu untuk network check
        function formatTime(date) {
            return date.toLocaleTimeString('id-ID', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        }
        
        // Fungsi untuk menyoroti teks yang cocok dengan pencarian
        function highlightText(text, keyword) {
            if (!keyword.trim()) return text;
            
            const regex = new RegExp(`(${keyword})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }
        
        // Tampilkan notifikasi
        function showNotification(message, type = 'success') {
            notificationText.textContent = message;
            
            // Atur warna berdasarkan tipe
            if (type === 'success') {
                notification.style.background = 'linear-gradient(135deg, #6a4fdb 0%, #4a2fa8 100%)';
                notification.children[0].className = 'fas fa-check-circle';
            } else if (type === 'error') {
                notification.style.background = 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)';
                notification.children[0].className = 'fas fa-exclamation-circle';
            } else if (type === 'info') {
                notification.style.background = 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)';
                notification.children[0].className = 'fas fa-info-circle';
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Tampilkan loading spinner
        function showLoading() {
            loadingSpinner.classList.add('active');
        }
        
        // Sembunyikan loading spinner
        function hideLoading() {
            loadingSpinner.classList.remove('active');
        }
        
        // Update counter di sidebar
        function updateCounters() {
            const bonusMemos = savedData.filter(item => 
                item.category === 'memo' && item.subcategory === 'MEMO PEMBAGIAN BONUS'
            );
            const bankMemos = savedData.filter(item => 
                item.category === 'memo' && item.subcategory === 'MEMO INFORMASI BANK'
            );
            const permainanMemos = savedData.filter(item => 
                item.category === 'memo' && item.subcategory === 'MEMO KENDALA PERMAINAN'
            );
            const sistemMemos = savedData.filter(item => 
                item.category === 'memo' && item.subcategory === 'MEMO KENDALA SISTEM'
            );
            const reportanData = savedData.filter(item => item.category === 'reportan');
            
            bonusCount.textContent = bonusMemos.length;
            bankCount.textContent = bankMemos.length;
            permainanCount.textContent = permainanMemos.length;
            sistemCount.textContent = sistemMemos.length;
            reportanCount.textContent = reportanData.length;
        }
        
        // ========== FUNGSI GOOGLE SHEETS API ==========
        
        // Fungsi untuk mengambil data dari Google Sheets
        async function fetchDataFromSheets() {
            showLoading();
            
            try {
                const response = await fetch(API_URL);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Proses data dari Google Sheets
                if (data.values && data.values.length > 0) {
                    const headers = data.values[0];
                    const rows = data.values.slice(1);
                    
                    savedData = rows.map(row => {
                        const obj = {};
                        headers.forEach((header, index) => {
                            obj[header] = row[index] || '';
                        });
                        return obj;
                    });
                    
                    // Simpan ke cache
                    localStorage.setItem('memoReportanDataCache', JSON.stringify(savedData));
                    
                    // Update counter
                    updateCounters();
                    
                    // Update status
                    updateApiStatus(true, `Terhubung (${savedData.length} data)`);
                    
                    showNotification(`Berhasil memuat ${savedData.length} data dari Spreadsheet`, 'success');
                } else {
                    // Sheet kosong
                    savedData = [];
                    localStorage.setItem('memoReportanDataCache', JSON.stringify(savedData));
                    updateCounters();
                    updateApiStatus(true, 'Spreadsheet kosong');
                    showNotification('Spreadsheet masih kosong', 'info');
                }
                
                return savedData;
            } catch (error) {
                console.error('Error fetching data:', error);
                
                // Fallback ke cache jika ada
                if (savedData.length > 0) {
                    showNotification('Menggunakan data cache, koneksi terputus', 'info');
                    updateApiStatus(false, 'Menggunakan data cache');
                } else {
                    updateApiStatus(false, 'Gagal terhubung ke Spreadsheet');
                    showNotification('Gagal mengambil data dari Spreadsheet', 'error');
                }
                
                return savedData;
            } finally {
                hideLoading();
            }
        }
        
        // Fungsi untuk menyimpan data ke Google Sheets
        async function saveDataToSheets(data) {
            showLoading();
            
            try {
                // Format data untuk Google Sheets
                const rowData = [
                    data.id || Date.now().toString(),
                    data.category,
                    data.subcategory || '',
                    data.judul,
                    data.isi,
                    new Date().toISOString()
                ];
                
                // Jika spreadsheet kosong, tambahkan header terlebih dahulu
                if (savedData.length === 0) {
                    const headerResponse = await fetch(API_URL);
                    const sheetData = await headerResponse.json();
                    
                    if (!sheetData.values || sheetData.values.length === 0) {
                        // Tambahkan header
                        const headerRequest = {
                            values: [['id', 'category', 'subcategory', 'judul', 'isi', 'timestamp']]
                        };
                        
                        await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/Sheet1!A1:F1?valueInputOption=USER_ENTERED&key=${API_KEY}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(headerRequest)
                        });
                    }
                }
                
                // Tambahkan data baru
                const requestBody = {
                    values: [rowData]
                };
                
                const response = await fetch(WRITE_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                
                // Refresh data dari server
                await fetchDataFromSheets();
                
                showNotification('Data berhasil disimpan ke Spreadsheet!', 'success');
                
                return result;
            } catch (error) {
                console.error('Error saving data:', error);
                showNotification('Gagal menyimpan ke Spreadsheet', 'error');
                
                // Fallback: simpan di localStorage
                data.id = 'local-' + Date.now();
                data.timestamp = new Date().toISOString();
                savedData.push(data);
                localStorage.setItem('memoReportanDataCache', JSON.stringify(savedData));
                updateCounters();
                
                return { success: false, message: 'Saved locally' };
            } finally {
                hideLoading();
            }
        }
        
        // Fungsi untuk menghapus semua data
        async function clearAllData() {
            if (!confirm(' PERINGATAN: Apakah Anda yakin ingin menghapus SEMUA data dari Spreadsheet? Tindakan ini tidak dapat dibatalkan!')) {
                return;
            }
            
            showLoading();
            
            try {
                const response = await fetch(CLEAR_API_URL, {
                    method: 'POST'
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                // Clear cache
                savedData = [];
                localStorage.removeItem('memoReportanDataCache');
                
                // Update counter
                updateCounters();
                
                // Render ulang jika sedang melihat data
                if (!isMainPage) {
                    if (activeCategory === 'memo' && activeSubcategory) {
                        renderSavedData('memo', activeSubcategory, currentSearchKeyword);
                    } else if (activeCategory === 'reportan') {
                        renderSavedData('reportan', '', currentSearchKeyword);
                    }
                }
                
                showNotification('Semua data berhasil dihapus dari Spreadsheet', 'success');
                
                return true;
            } catch (error) {
                console.error('Error clearing data:', error);
                showNotification('Gagal menghapus data dari Spreadsheet', 'error');
                return false;
            } finally {
                hideLoading();
            }
        }
        
        // Update status API
        function updateApiStatus(isOnline, message) {
            if (isOnline) {
                apiStatus.className = 'api-status online';
                apiStatusDot.className = 'api-status-dot online';
                apiStatusText.textContent = message;
            } else {
                apiStatus.className = 'api-status offline';
                apiStatusDot.className = 'api-status-dot offline';
                apiStatusText.textContent = message;
            }
        }
        
        // ========== FUNGSI RENDER DATA ==========
        
        // Tampilkan data yang tersimpan berdasarkan subkategori dan pencarian
        function renderSavedData(category, subcategory = '', keyword = '') {
            let filteredData = [];
            
            if (category === 'memo' && subcategory) {
                // Filter data berdasarkan subkategori memo
                filteredData = savedData.filter(item => 
                    item.category === 'memo' && item.subcategory === subcategory
                );
            } else if (category === 'reportan') {
                // Filter data untuk reportan
                filteredData = savedData.filter(item => item.category === 'reportan');
            }
            
            // Terapkan filter pencarian jika ada kata kunci
            if (keyword.trim()) {
                const searchLower = keyword.toLowerCase();
                filteredData = filteredData.filter(item => {
                    const judulLower = item.judul ? item.judul.toLowerCase() : '';
                    const isiLower = item.isi ? item.isi.toLowerCase() : '';
                    return judulLower.includes(searchLower) || isiLower.includes(searchLower);
                });
                
                // Update info pencarian
                searchInfo.innerHTML = `<i class="fas fa-search"></i> Ditemukan ${filteredData.length} hasil untuk "${keyword}"`;
            } else {
                // Reset info pencarian
                searchInfo.innerHTML = `<i class="fas fa-info-circle"></i> Data diambil langsung dari Google Spreadsheet`;
            }
            
            if (filteredData.length === 0) {
                let message = 'Belum ada data';
                let subMessage = 'Tambah data baru untuk melihatnya di sini';
                
                if (keyword.trim()) {
                    if (category === 'memo' && subcategory) {
                        const subcategoryName = subcategory.replace('MEMO ', '');
                        message = `Tidak ditemukan hasil untuk "${keyword}"`;
                        subMessage = `Coba kata kunci lain di ${subcategoryName}`;
                    } else if (category === 'reportan') {
                        message = `Tidak ditemukan hasil untuk "${keyword}"`;
                        subMessage = 'Coba kata kunci lain di Reportan';
                    }
                } else {
                    if (category === 'memo' && subcategory) {
                        const subcategoryName = subcategory.replace('MEMO ', '');
                        message = `Belum ada data di ${subcategoryName}`;
                        subMessage = 'Spreadsheet Anda masih kosong';
                    } else if (category === 'reportan') {
                        message = 'Belum ada data reportan';
                        subMessage = 'Spreadsheet Anda masih kosong';
                    }
                }
                
                dataGrid.innerHTML = `
                    <div class="empty-data">
                        <i class="fas fa-${keyword.trim() ? 'search' : 'inbox'}"></i>
                        <h3>${message}</h3>
                        <p>${subMessage}</p>
                    </div>
                `;
                return;
            }
            
            dataGrid.innerHTML = '';
            
            // Urutkan data berdasarkan tanggal (terbaru di atas)
            const sortedData = [...filteredData].sort((a, b) => {
                const dateA = a.timestamp ? new Date(a.timestamp) : new Date(0);
                const dateB = b.timestamp ? new Date(b.timestamp) : new Date(0);
                return dateB - dateA;
            });
            
            sortedData.forEach((item, index) => {
                const dataItem = document.createElement('div');
                dataItem.className = 'data-item';
                
                let categoryBadge = '';
                let subcategoryBadge = '';
                
                if (item.category === 'memo') {
                    categoryBadge = `<span class="data-category">MEMO</span>`;
                    subcategoryBadge = `<span class="data-subcategory" data-subcategory="${item.subcategory}">${item.subcategory}</span>`;
                } else {
                    categoryBadge = `<span class="data-category">REPORTAN</span>`;
                }
                
                // Sorot teks yang cocok dengan pencarian
                const highlightedJudul = keyword.trim() ? highlightText(item.judul, keyword) : item.judul;
                const highlightedIsi = keyword.trim() ? highlightText(item.isi, keyword) : item.isi;
                
                dataItem.innerHTML = `
                    ${categoryBadge}${subcategoryBadge}
                    <div class="data-title">${highlightedJudul}</div>
                    <div class="data-content">${highlightedIsi}</div>
                    <div class="data-date">
                        <i class="far fa-calendar-alt"></i> ${item.timestamp ? formatDate(item.timestamp) : 'Tanggal tidak tersedia'}
                        ${item.id && item.id.startsWith('local-') ? '<span style="margin-left: 10px; background: #f39c12; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.75rem;">Lokal</span>' : ''}
                    </div>
                `;
                
                dataGrid.appendChild(dataItem);
            });
        }
        
        // Reset form
        function resetForm() {
            memoFormData.reset();
            memoSubcategorySelect.value = '';
        }
        
        // ========== FUNGSI SIDEBAR ==========
        
        // Fungsi untuk toggle expand/collapse submenu memo
        function toggleMemoSubmenu() {
            isMemoSubmenuExpanded = !isMemoSubmenuExpanded;
            
            if (isMemoSubmenuExpanded) {
                memoSubmenu.classList.add('expanded');
                memoArrow.classList.remove('rotated');
            } else {
                memoSubmenu.classList.remove('expanded');
                memoArrow.classList.add('rotated');
            }
        }
        
        // Fungsi untuk toggle minimize sidebar
        function toggleSidebarMinimize() {
            isSidebarMinimized = !isSidebarMinimized;
            
            if (isSidebarMinimized) {
                sidebar.classList.add('minimized');
                minimizeBtn.style.transform = 'rotate(180deg) scale(1.2)';
                setTimeout(() => {
                    minimizeBtn.style.transform = 'rotate(180deg) scale(1)';
                }, 300);
                
                if (isMemoSubmenuExpanded) {
                    toggleMemoSubmenu();
                }
            } else {
                sidebar.classList.remove('minimized');
                minimizeBtn.style.transform = 'rotate(0deg) scale(1.2)';
                setTimeout(() => {
                    minimizeBtn.style.transform = 'rotate(0deg) scale(1)';
                }, 300);
            }
            
            localStorage.setItem('sidebarMinimized', isSidebarMinimized);
        }
        
        // ========== FUNGSI NETWORK CHECKER ==========
        
        // Fungsi untuk melakukan tes network
        async function performNetworkTest() {
            networkIcon.classList.add('network-loading');
            networkPing.textContent = '...';
            networkStatusDot.className = 'network-status-dot';
            networkLatency.textContent = '...';
            networkStatus.textContent = 'Memeriksa...';
            networkStatus.className = 'network-status';
            
            const startTime = Date.now();
            lastNetworkCheckTime = new Date();
            
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000);
                
                const response = await fetch('https://www.google.com/favicon.ico', {
                    method: 'HEAD',
                    mode: 'no-cors',
                    signal: controller.signal,
                    cache: 'no-cache'
                });
                
                clearTimeout(timeoutId);
                
                const endTime = Date.now();
                const latency = endTime - startTime;
                
                updateNetworkDisplay(latency, 'online');
                networkLastChecked.textContent = formatTime(lastNetworkCheckTime);
                showNetworkResult();
                
            } catch (error) {
                updateNetworkDisplay(null, 'offline');
                networkLastChecked.textContent = formatTime(lastNetworkCheckTime);
                showNetworkResult();
            } finally {
                networkIcon.classList.remove('network-loading');
            }
        }
        
        // Update tampilan network berdasarkan hasil
        function updateNetworkDisplay(latency, status) {
            networkStatusDot.className = 'network-status-dot';
            networkStatus.className = 'network-status';
            
            if (status === 'online') {
                if (latency < 100) {
                    networkStatusDot.classList.add('online');
                    networkPing.textContent = `${latency}ms`;
                    networkPing.style.color = '#2ecc71';
                    networkLatency.textContent = `${latency} ms`;
                    networkStatus.textContent = 'Online Stabil';
                    networkStatus.classList.add('network-status-online');
                } else if (latency < 300) {
                    networkStatusDot.classList.add('slow');
                    networkPing.textContent = `${latency}ms`;
                    networkPing.style.color = '#f39c12';
                    networkLatency.textContent = `${latency} ms`;
                    networkStatus.textContent = 'Online Lambat';
                    networkStatus.classList.add('network-status-slow');
                } else {
                    networkStatusDot.classList.add('offline');
                    networkPing.textContent = `${latency}ms`;
                    networkPing.style.color = '#e74c3c';
                    networkLatency.textContent = `${latency} ms`;
                    networkStatus.textContent = 'Sangat Lambat';
                    networkStatus.classList.add('network-status-offline');
                }
            } else {
                networkStatusDot.classList.add('offline');
                networkPing.textContent = 'Offline';
                networkPing.style.color = '#e74c3c';
                networkLatency.textContent = '';
                networkStatus.textContent = 'Offline';
                networkStatus.classList.add('network-status-offline');
            }
        }
        
        // Tampilkan hasil network
        function showNetworkResult() {
            networkResult.classList.add('show');
            networkResultVisible = true;
            
            setTimeout(() => {
                if (networkResultVisible) {
                    networkResult.classList.remove('show');
                    networkResultVisible = false;
                }
            }, 5000);
        }
        
        // Sembunyikan hasil network
        function hideNetworkResult() {
            networkResult.classList.remove('show');
            networkResultVisible = false;
        }
        
        // ========== FUNGSI HALAMAN ==========
        
        // Set tampilan untuk halaman utama (Menu Depan)
        function setMainPage() {
            isMainPage = true;
            activeCategory = 'memo';
            activeSubcategory = '';
            currentSearchKeyword = '';
            
            menuItems.forEach(item => {
                if (item === mainMenuMemo) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            submenuItems.forEach(item => {
                item.classList.remove('active');
            });
            
            if (isMemoSubmenuExpanded) {
                memoSubmenu.classList.add('expanded');
                memoArrow.classList.remove('rotated');
            } else {
                memoSubmenu.classList.remove('expanded');
                memoArrow.classList.add('rotated');
            }
            
            headerIcon.className = 'fas fa-sticky-note';
            pageTitle.textContent = 'MEMO LINE';
            pageSubtitle.textContent = 'Database Cloud - Data Tersimpan di Spreadsheet Anda';
            dataContainer.classList.remove('active');
            memoForm.style.display = 'block';
            searchInput.value = '';
            hideNetworkResult();
        }
        
        // Set tampilan untuk subkategori memo
        function setMemoSubcategoryPage(subcategory) {
            isMainPage = false;
            activeCategory = 'memo';
            activeSubcategory = subcategory;
            currentSearchKeyword = '';
            
            menuItems.forEach(item => {
                if (item.dataset.category === 'memo') {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            submenuItems.forEach(item => {
                if (item.dataset.subcategory === subcategory) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            if (isMemoSubmenuExpanded) {
                memoSubmenu.classList.add('expanded');
                memoArrow.classList.remove('rotated');
            } else {
                memoSubmenu.classList.remove('expanded');
                memoArrow.classList.add('rotated');
            }
            
            let iconClass = 'fas fa-sticky-note';
            if (subcategory === 'MEMO PEMBAGIAN BONUS') {
                iconClass = 'fas fa-gift';
            } else if (subcategory === 'MEMO INFORMASI BANK') {
                iconClass = 'fas fa-university';
            } else if (subcategory === 'MEMO KENDALA PERMAINAN') {
                iconClass = 'fas fa-gamepad';
            } else if (subcategory === 'MEMO KENDALA SISTEM') {
                iconClass = 'fas fa-server';
            }
            headerIcon.className = iconClass;
            
            const subcategoryName = subcategory.replace('MEMO ', '');
            pageTitle.textContent = subcategory;
            pageSubtitle.textContent = `Data tersimpan untuk ${subcategoryName}`;
            dataTitle.innerHTML = `<i class="${iconClass}"></i> ${subcategory}`;
            memoForm.style.display = 'none';
            dataContainer.classList.add('active');
            searchInput.value = '';
            renderSavedData('memo', subcategory, '');
            hideNetworkResult();
        }
        
        // Set tampilan untuk reportan
        function setReportanPage() {
            isMainPage = false;
            activeCategory = 'reportan';
            activeSubcategory = '';
            currentSearchKeyword = '';
            
            menuItems.forEach(item => {
                if (item.dataset.category === 'reportan') {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            submenuItems.forEach(item => {
                item.classList.remove('active');
            });
            
            headerIcon.className = 'fas fa-file-alt';
            pageTitle.textContent = 'REPORTAN';
            pageSubtitle.textContent = 'Data reportan yang tersimpan';
            dataTitle.innerHTML = '<i class="fas fa-file-alt"></i> Data Reportan';
            memoForm.style.display = 'none';
            dataContainer.classList.add('active');
            searchInput.value = '';
            renderSavedData('reportan', '', '');
            hideNetworkResult();
        }
        
        // ========== EVENT LISTENERS ==========
        
        // Event Listeners untuk menu item utama (MEMO)
        mainMenuMemo.addEventListener('click', (e) => {
            if (e.target.closest('.menu-item-arrow')) {
                toggleMemoSubmenu();
            } else {
                setMainPage();
                if (window.innerWidth <= 992) {
                    sidebar.classList.remove('show');
                }
            }
        });
        
        // Event Listeners untuk submenu item memo
        submenuItems.forEach(item => {
            item.addEventListener('click', () => {
                const subcategory = item.dataset.subcategory;
                setMemoSubcategoryPage(subcategory);
                if (window.innerWidth <= 992) {
                    sidebar.classList.remove('show');
                }
            });
        });
        
        // Event Listener untuk menu reportan
        menuItems.forEach(item => {
            if (item.dataset.category === 'reportan') {
                item.addEventListener('click', () => {
                    setReportanPage();
                    if (window.innerWidth <= 992) {
                        sidebar.classList.remove('show');
                    }
                });
            }
        });
        
        // Event Listener untuk form memo
        memoFormData.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const subcategory = memoSubcategorySelect.value;
            const judul = memoJudulInput.value.trim();
            const isi = memoIsiInput.value.trim();
            
            if (!subcategory) {
                showNotification('Silakan pilih subkategori memo!', 'error');
                return;
            }
            
            if (!judul || !isi) {
                showNotification('Judul dan isi memo harus diisi!', 'error');
                return;
            }
            
            const data = {
                category: 'memo',
                subcategory: subcategory,
                judul: judul,
                isi: isi
            };
            
            const result = await saveDataToSheets(data);
            if (result && !result.error) {
                resetForm();
            }
        });
        
        // Event Listener untuk hapus semua data
        clearDataBtn.addEventListener('click', () => {
            clearAllData();
        });
        
        // Event Listener untuk refresh data
        refreshDataBtn.addEventListener('click', async () => {
            showNotification('Memperbarui data dari Spreadsheet...', 'info');
            await fetchDataFromSheets();
            
            if (!isMainPage) {
                if (activeCategory === 'memo' && activeSubcategory) {
                    renderSavedData('memo', activeSubcategory, currentSearchKeyword);
                } else if (activeCategory === 'reportan') {
                    renderSavedData('reportan', '', currentSearchKeyword);
                }
            }
            
            showNotification('Data berhasil diperbarui', 'success');
        });
        
        // Event Listener untuk pencarian
        searchInput.addEventListener('input', (e) => {
            currentSearchKeyword = e.target.value.trim();
            
            if (!isMainPage) {
                if (activeCategory === 'memo' && activeSubcategory) {
                    renderSavedData('memo', activeSubcategory, currentSearchKeyword);
                } else if (activeCategory === 'reportan') {
                    renderSavedData('reportan', '', currentSearchKeyword);
                }
            }
        });
        
        // Event Listener untuk hapus pencarian
        clearSearchBtn.addEventListener('click', () => {
            searchInput.value = '';
            currentSearchKeyword = '';
            
            if (!isMainPage) {
                if (activeCategory === 'memo' && activeSubcategory) {
                    renderSavedData('memo', activeSubcategory, '');
                } else if (activeCategory === 'reportan') {
                    renderSavedData('reportan', '', '');
                }
            }
        });
        
        // Event Listener untuk network checker
        networkChecker.addEventListener('click', () => {
            performNetworkTest();
        });
        
        // Event listener untuk menyembunyikan hasil network saat klik di luar
        document.addEventListener('click', (e) => {
            if (!networkChecker.contains(e.target) && !networkResult.contains(e.target)) {
                hideNetworkResult();
            }
        });
        
        // Event Listener untuk toggle sidebar di mobile
        toggleSidebarBtn.addEventListener('click', () => {
            sidebar.classList.toggle('show');
        });
        
        // Event Listener untuk minimize sidebar
        minimizeBtn.addEventListener('click', () => {
            toggleSidebarMinimize();
        });
        
        // Event Listener untuk lihat spreadsheet
        viewSpreadsheetBtn.addEventListener('click', () => {
            window.open(`https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/edit`, '_blank');
        });
        
        // Tutup sidebar saat klik di luar pada mobile
        document.addEventListener('click', (e) => {
            if (window.innerWidth <= 992 && 
                !sidebar.contains(e.target) && 
                e.target !== toggleSidebarBtn && 
                !toggleSidebarBtn.contains(e.target)) {
                sidebar.classList.remove('show');
            }
        });
        
        // ========== INISIALISASI ==========
        
        async function init() {
            // Set status minimize sidebar dari localStorage
            if (isSidebarMinimized) {
                sidebar.classList.add('minimized');
            }
            
            // Set halaman utama saat pertama kali dibuka
            setMainPage();
            
            // Perbarui tanggal dan jam
            updateDateDisplay();
            updateClock();
            
            // Update jam setiap detik
            setInterval(updateClock, 1000);
            
            // Load data dari Google Sheets
            showNotification('Memuat data dari Spreadsheet Anda...', 'info');
            await fetchDataFromSheets();
            
            // Update counters
            updateCounters();
            
            // Lakukan tes network otomatis
            setTimeout(() => {
                performNetworkTest();
            }, 1000);
            
            // Jadwalkan tes network otomatis setiap 2 menit
            setInterval(() => {
                performNetworkTest();
            }, 120000);
            
            // Perbarui tanggal setiap menit
            setInterval(() => {
                updateDateDisplay();
            }, 60000);
            
            // Refresh data setiap 3 menit
            setInterval(async () => {
                await fetchDataFromSheets();
                if (!isMainPage) {
                    if (activeCategory === 'memo' && activeSubcategory) {
                        renderSavedData('memo', activeSubcategory, currentSearchKeyword);
                    } else if (activeCategory === 'reportan') {
                        renderSavedData('reportan', '', currentSearchKeyword);
                    }
                }
            }, 180000);
        }
        
        // Jalankan inisialisasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
